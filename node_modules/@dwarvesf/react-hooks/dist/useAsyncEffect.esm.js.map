{"version":3,"file":"useAsyncEffect.esm.js","sources":["../src/useAsyncEffect.ts"],"sourcesContent":["import { useEffect } from 'react'\n\nexport default function useAsyncEffect<Data = any>(\n  callback: (isMounted: () => boolean) => Data | Promise<Data>,\n  onDestroyOrDependencies: null | ((result?: Data) => void) | any[] = [],\n  dependencies: any[] = [],\n) {\n  let deps: any[]\n  let destroy: (result?: Data) => void\n\n  if (typeof onDestroyOrDependencies === 'function') {\n    destroy = onDestroyOrDependencies\n    deps = dependencies\n  } else {\n    deps = onDestroyOrDependencies || []\n  }\n\n  useEffect(() => {\n    let result: Data\n    let mounted = true\n\n    const maybePromise = callback(() => {\n      return mounted\n    })\n\n    Promise.resolve(maybePromise).then((value) => {\n      result = value\n    })\n\n    return () => {\n      mounted = false\n\n      if (typeof destroy === 'function') {\n        destroy(result)\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps)\n}\n"],"names":["useAsyncEffect","callback","onDestroyOrDependencies","dependencies","deps","destroy","useEffect","result","mounted","maybePromise","Promise","resolve","then","value"],"mappings":";;SAEwBA,eACtBC,UACAC,yBACAC;MADAD;AAAAA,IAAAA,0BAAoE;;;MACpEC;AAAAA,IAAAA,eAAsB;;;AAEtB,MAAIC,IAAJ;AACA,MAAIC,OAAJ;;AAEA,MAAI,OAAOH,uBAAP,KAAmC,UAAvC,EAAmD;AACjDG,IAAAA,OAAO,GAAGH,uBAAV;AACAE,IAAAA,IAAI,GAAGD,YAAP;AACD,GAHD,MAGO;AACLC,IAAAA,IAAI,GAAGF,uBAAuB,IAAI,EAAlC;AACD;;AAEDI,EAAAA,SAAS,CAAC;AACR,QAAIC,MAAJ;AACA,QAAIC,OAAO,GAAG,IAAd;AAEA,QAAMC,YAAY,GAAGR,QAAQ,CAAC;AAC5B,aAAOO,OAAP;AACD,KAF4B,CAA7B;AAIAE,IAAAA,OAAO,CAACC,OAAR,CAAgBF,YAAhB,EAA8BG,IAA9B,CAAmC,UAACC,KAAD;AACjCN,MAAAA,MAAM,GAAGM,KAAT;AACD,KAFD;AAIA,WAAO;AACLL,MAAAA,OAAO,GAAG,KAAV;;AAEA,UAAI,OAAOH,OAAP,KAAmB,UAAvB,EAAmC;AACjCA,QAAAA,OAAO,CAACE,MAAD,CAAP;AACD;AACF,KAND;AAQD,GApBQ,EAoBNH,IApBM,CAAT;AAqBD;;;;"}